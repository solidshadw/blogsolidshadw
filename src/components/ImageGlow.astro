---
import { Image } from 'astro:assets';
import type { LocalImageProps, RemoteImageProps } from 'astro:assets';

type Props = LocalImageProps | RemoteImageProps;

const { quality = 100, ...props } = Astro.props;

const width = props.width;
const height = props.height;
---

<div class="glow-image">
  <Image {...props} quality={quality} />
  <Image
    width={width ? ((typeof width === 'number' ? width : Number.parseInt(width)) / 4) : undefined} 
    height={height ? ((typeof height === 'number' ? height : Number.parseInt(height)) / 4) : undefined}
    {...props}
    class='glow'
    class:list={[props.class]}
    quality={75}
  />
</div>
<style>
  .glow-image {
    position: relative;
    display: inline-block;
  }

  .glow-image img {
    position: relative;
    z-index: 1;
    width: auto !important;
    height: auto !important;
    max-width: none !important;
    display: block;
    image-rendering: -moz-crisp-edges;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    image-rendering: pixelated;
  }

  .glow {
    position: absolute !important;
    top: 0;
    left: 0;
    z-index: 0 !important;
    filter: blur(8px);
    width: 100% !important;
    height: auto !important;
    image-rendering: -moz-crisp-edges;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    image-rendering: pixelated;
  }
</style>